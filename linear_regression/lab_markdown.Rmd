---
title: 'Lab 2: Linear Regression'
author: "Lizzy Presland"
date: "January 23, 2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


## Exploring and preparing the data

The data is taken from the .csv file posted on the class Canvas page.

#### Q1: Load the data

To load the data, we would normally use: 

```
ins_data <- read.csv("insurance.csv", header=TRUE)
```

As far as I can tell, we can load data with `stringsAsFactors=TRUE` in order for R to correctly parse the file and load a simple dataframe. However, we will want to use `stringsAsFactor=FALSE` in order to perform ***linear regression analysis*** on the data.

Therefore, our load function becomes:

```{r include=TRUE}
ins_data <- read.csv("insurance.csv", header=TRUE, stringsAsFactors = TRUE)
```

#### Q2: Data structure

```{r}
head(ins_data)
summary(ins_data)
```

#### Q3: Independent and dependent variables

The dependent feature is the **charges** column (the amount of money the insurance company can expect to pay for healthcare costs); the independent features are all others (**age**, **sex**, **bmi**, **number of children**, **tobacco use**, and **geographic region**).

#### Q4: Dependent feature analysis

It is best to analyze the dependent feature numerically; I shall use graphical and numerical methods.

#### Q5: Determine data's normal distribution

#### Histogram

```{r}
hist(ins_data$charges)
```

As the histogram shows, the data does not appear to be normally distributed; there appears to be a strong right skew to the data.

#### Numerical Methods

```{r include=FALSE}
cat("Mean: ")
mean(ins_data$charges)
cat("\nMedian: ")
median(ins_data$charges)
```

## Exploring relationships among features using a correlation matrix

#### Q7: create the correlation matrix

```{r}
numerics <- ins_data[,c(1, 3, 4, 7)]
head(numerics)
cor(numerics, numerics)
```

**NOTE:** It was tricky getting all 4 numerical values into a matrix as described, and took some intuition to figure out what was desired. It would be helpful to review this in class.

#### Q8: reflect on patterns in matrix

The two categories with the closest relationship are **age** and **charges**, which isn't surprising given that conventional wisdom dictates that healthcare costs increase with age.

The next most significant correlation is between **BMI** (body mass index) and **charges**, which is unsurprising for similar reasons; according to conventional wisdom, overweight people are more likely to have health problems and/or spend more money on healthcare.

## Visualizing relationships using a scatterplot matrix

#### Q9: the scatterplot matrix

```{r}
pairs(numerics)
```

#### Q10: Interesting observations in scatterplots

I found the scatterplot of the BMI and charges to be particularly interesting.

```{r}
plot(numerics$bmi, numerics$charges)
```

There are clustering patterns of high and low charges for the same BMI range (approx 30-40 BMI). The visual disparity of these two clusters indicate that there is a pattern of healthcare spending for these individuals, and because the data is not evenly distributed through the cost spectrum in this range of BMI values, there may be an underlying pattern or set of circumstances dictating this behavior.

#### Q11: enhanced scatterplot matrix

```{r}
library("psych")
pairs.panels(numerics)
```

#### Q12: new observations with enhanced scatterplot

* There appears to be a strong correlation between age and charges per the loess curve.
* BMI appears to be normally distributed
* Age is approximately evenly distrubted
* Nmber of children & total charges are heavily right-skewed
* The average number of children is quite low (around 1) for the sampled population.
* For all other variables besides charges, the mean charges is quite low on the linear scale of dollar amounts (per the axis ranges).
* Lastly, this is a super informative plot! Very cool.